<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-117029737-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>Integration Tests | Carl Paton | There are no silly questions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="WIP  Every team you work in will have their own understanding of integration tests, I tried to explain this better in my post on Testing Strategies A general explanation of integration tests could be">
<meta property="og:type" content="article">
<meta property="og:title" content="Integration Tests">
<meta property="og:url" content="https://carlpaton.github.io/2022/01/integration-tests/index.html">
<meta property="og:site_name" content="There are no silly questions">
<meta property="og:description" content="WIP  Every team you work in will have their own understanding of integration tests, I tried to explain this better in my post on Testing Strategies A general explanation of integration tests could be">
<meta property="og:locale">
<meta property="og:image" content="https://carlpaton.github.io/d/integration-tests/crosses-project-boundaries.png">
<meta property="og:image" content="https://carlpaton.github.io/d/integration-tests/crossing-unit-boundaries.png">
<meta property="article:published_time" content="2022-01-30T11:00:00.000Z">
<meta property="article:modified_time" content="2022-03-01T00:39:40.740Z">
<meta property="article:author" content="Carl Paton">
<meta property="article:tag" content="wip">
<meta property="article:tag" content="software testing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://carlpaton.github.io/d/integration-tests/crosses-project-boundaries.png">
  
    <link rel="alternate" href="/atom.xml" title="There are no silly questions" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <nav id="mobile-nav">
  
    <a href="/about/" class="mobile-nav-link">About</a>
  
    <a href="/tags/aws/" class="mobile-nav-link">AWS</a>
  
    <a href="/tags/c/" class="mobile-nav-link">C#</a>
  
    <a href="/tags/docker/" class="mobile-nav-link">Docker</a>
  
    <a href="/2020/02/design-patterns/" class="mobile-nav-link">Design Patterns</a>
  
    <a href="/tags/learning-resources/" class="mobile-nav-link">Learning</a>
  
    <a href="/tags/patterns-principles/" class="mobile-nav-link">Patterns Principles</a>
  
</nav>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a class="main-nav-link" href="/" id="logo" title="There are no silly questions"
        >Carl Paton</a
      >

      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
        <a class="main-nav-link" href="/about/"
          >About</a
        >
        
        <a class="main-nav-link" href="/tags/aws/"
          >AWS</a
        >
        
        <a class="main-nav-link" href="/tags/c/"
          >C#</a
        >
        
        <a class="main-nav-link" href="/tags/docker/"
          >Docker</a
        >
        
        <a class="main-nav-link" href="/2020/02/design-patterns/"
          >Design Patterns</a
        >
        
        <a class="main-nav-link" href="/tags/learning-resources/"
          >Learning</a
        >
        
        <a class="main-nav-link" href="/tags/patterns-principles/"
          >Patterns Principles</a
        >
        
		<!--
        <a class="main-nav-link" href="/about/">About</a>
		-->
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-integration-tests" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/01/integration-tests/" class="article-date">
  <time datetime="2022-01-30T11:00:00.000Z" itemprop="datePublished">2022-Jan</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Integration Tests
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a href="/2017/06/work-in-progress/">WIP</a></p>
</blockquote>
<p>Every team you work in will have their own understanding of <code>integration tests</code>, I tried to explain this better in my post on <a href="/2021/01/testing-strategies/">Testing Strategies</a></p>
<p>A general explanation of <code>integration tests</code> could be as follows:</p>
<blockquote>
<p>Code that invokes a unit of work that crosses project boundaries, uses actual external dependencies, and/or validates many different aspects about the code under test.</p>
</blockquote>
<p>This can visually be understood as</p>
<p><img src="/d/integration-tests/crosses-project-boundaries.png" alt="Integration test crosses project boundaries"></p>
<p>That said, the integration can also be seen as the integration of units of work with-in your application. These units of work could be services or <a href="/2020/08/cqrs/">command/queries</a>. Depending on what these units actually do they could be crossing project boundaries. </p>
<p>Examples</p>
<ul>
<li><code>Unit b</code> may implement a http client that interacts with an external API - thats outside of your projects boundary. So the above image reflects this.</li>
<li><code>Unit b</code> may implement some math calculations like <code>return 42 + 0;</code> - thats inside your projects boundary but it still integrates with <code>Unit a</code></li>
</ul>
<p><img src="/d/integration-tests/crossing-unit-boundaries.png" alt="Integration test crossing unit boundaries"></p>
<h1 id="Integration-Test-example"><a href="#Integration-Test-example" class="headerlink" title="Integration Test example"></a>Integration Test example</h1><p>Iâ€™ve worked in teams where <code>Integration Tests</code> are re-used, the external dependencies are mocked out with another appsettings file. This is in my opinion then a <code>Component Test</code>, I view the two units above <code>unit a</code> and <code>unit b</code> together as a component.</p>
<p>Depending on what the test actually does it could be an E2E test (End to End)</p>
<p>Naming is tricky, however as a team we decided on the terminology <code>Mock Integration Test</code> as a <code>component</code> in front end development means something else. As our app was .Net the example appsettings name was <code>appsettings.Mock.json</code> - its important to define the terms as a team and then stick to them. </p>
<h2 id="Using-a-fixture"><a href="#Using-a-fixture" class="headerlink" title="Using a fixture"></a>Using a fixture</h2><p>It makes sense to break the tests down but still group them by <code>Features</code> - these should be already grouped by your controllers. By design controllers are allowed to do too much, you can add as many endpoints in them as you like - thats a different topic, see <a target="_blank" rel="noopener" href="https://ardalis.com/mvc-controllers-are-dinosaurs-embrace-api-endpoints/">MVC Controllers are Dinosaurs - Embrace API Endpoints</a>. For my features examples however grouping responsability makes integration testing by feature easier.</p>
<p>Consider these controllers, <code>Artists</code> has simple <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/CRUD">CRUD</a> operations and so does <code>Songs</code>, these operations are abstracted away and then <a href="/2018/04/dependency-inversion-principle-dip/">injected as an interface</a>, using the <code>Controllers</code> folder is simply following <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Convention_over_configuration">convention over configuration</a>.</p>
<p>I would understand this as one <code>Artist</code> has many <code>Songs</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Foo.Api&#x2F;Controllers&#x2F;ArtistsController.cs</span><br><span class="line">Foo.Api&#x2F;Controllers&#x2F;SongsController.cs</span><br></pre></td></tr></table></figure>

<p>The integration tests could then be created as <code>Features/Artists</code> and <code>Features/Songs</code>, understandably there could be overlap if a Artist is persisted with some songs - ideally the link would just be the foreign key and not the whole implementation so <a href="/2020/11/what-makes-a-great-api/">design considerations need to thought out</a>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Foo.Api.IntegrationTests&#x2F;Features&#x2F;Artists&#x2F;</span><br><span class="line">Foo.Api.IntegrationTests&#x2F;Features&#x2F;Songs&#x2F;</span><br></pre></td></tr></table></figure>

<p>The abstractions the controller instantiates though <a href="/2018/09/dependency-injection-frameworks/">dependency injection</a> would still be injected by the applications framework, their behavior also doesnt change however the configuration (appsettings in .Net) can be changed by environment. This means the application needs to have the same <code>appsettings</code> values as the integration tests.</p>
<h3 id="Collection-Fixtures"><a href="#Collection-Fixtures" class="headerlink" title="Collection Fixtures"></a>Collection Fixtures</h3><blockquote>
<p><strong>When to use</strong>: when you want to create a single test context and share it among tests in several test classes, and have it cleaned up after all the tests in the test classes have finished. - xunit.net/docs/shared-context</p>
</blockquote>
<p>The tests can use something called a <code>Fixture</code> to instantiate their dependencys. One or more fixtures are then injected into our tests. So below the <code>CollectionFixture</code> is really a base class to share context between tests.</p>
<p>Example <code>Foo.Api.IntegrationTests/Fixtures/CollectionFixture.cs</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CollectionFixture</span> : <span class="title">IAsyncLifetime</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> FooServiceClient _client;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> FooBarOptions _fooBar;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CollectionFixture</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> appSettings = <span class="string">&quot;appsettings.Mock.json&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (Environment.GetEnvironmentVariable(<span class="string">&quot;DOTNET_ENVIRONMENT&quot;</span>) == <span class="string">&quot;Uat&quot;</span>)</span><br><span class="line">            appSettings = <span class="string">&quot;appsettings.Uat.json&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> configuration = <span class="keyword">new</span> ConfigurationBuilder()</span><br><span class="line">            .AddJsonFile(appSettings)</span><br><span class="line">            .Build();</span><br><span class="line"></span><br><span class="line">        _fooBar = configuration</span><br><span class="line">            .GetSection(FooBarOptions.FooBar)</span><br><span class="line">            .Get&lt;List&lt;FooBarOptions&gt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> FooServiceClient FooServiceClient</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_client != <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">return</span> _client;</span><br><span class="line"></span><br><span class="line">            _client = <span class="keyword">new</span> FooService(_fooBar);</span><br><span class="line">            <span class="keyword">return</span> _client;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ... DisposeAsync, InitializeAsync</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We use <code>IAsyncLifetime</code> to call into the services to dispose of resources. If you use <code>InitializeAsync</code> here to seed any data you must remember its for all tests. If you want to seed data just for a subset then see <code>Class Fixtures</code> below.</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Task <span class="title">DisposeAsync</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _client?.Dispose();</span><br><span class="line">    <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Task <span class="title">InitializeAsync</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// seed data for your tests </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// then return</span></span><br><span class="line">    <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To then allow the <code>CollectionFixture</code> to be instanciated and managed we need to create a <code>SharedCollectionFixture</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">CollectionDefinition(<span class="meta-string">&quot;Shared Collection Fixture&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SharedCollectionFixture</span> : <span class="title">ICollectionFixture</span>&lt;<span class="title">CollectionFixture</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// no implementation</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Test classes that want to use <code>CollectionFixture</code> should be decorated with <code>[Collection(&quot;Shared Collection Fixture&quot;)]</code>. Their constructor parameters can then include <code>CollectionFixture collectionFixture</code>. The facts can then access <code>_collectionFixture.FooServiceClient</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Collection(<span class="meta-string">&quot;Shared Collection Fixture&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ArtistTests</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> CollectionFixture _collectionFixture;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArtistTests</span>(<span class="params">CollectionFixture collectionFixture</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _collectionFixture = collectionFixture;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Fact</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">U_I_E</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// Arrange</span></span><br><span class="line">        <span class="comment">// Act</span></span><br><span class="line">        <span class="comment">// Assert</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="FooServiceClient"><a href="#FooServiceClient" class="headerlink" title="FooServiceClient"></a>FooServiceClient</h4><p>The <code>FooServiceClient</code> should inherit/implement <code>IDisposable</code> to dispose of any clients it may have. This is called from the fixtures <code>DisposeAsync</code> method to ensure all state is disposed of.</p>
<p><code> GC.SuppressFinalize(this)</code> will prevent derived types that introduce a finalizer from needing to re-implement IDisposable to call it. See <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1816">CA1816: Call GC.SuppressFinalize correctly</a></p>
<p>Alternatively the client <code>FooServiceClient</code> could use the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/sealed">sealed keyword</a> to prevent inheritance.</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FooServiceClient</span> : <span class="title">IDisposable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> HttpClient _client;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FooServiceClient</span>(<span class="params">FooServiceOptions fooServiceOptions_</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _client = <span class="keyword">new</span> HttpClient &#123; BaseAddress = <span class="keyword">new</span> Uri(fooServiceOptions_.Url) &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ArtistDto&gt; <span class="title">GetArtistAsync</span>(<span class="params">Guid artistId</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// ... </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dispose</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _client.Dispose();</span><br><span class="line">        GC.SuppressFinalize(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Class-Fixtures"><a href="#Class-Fixtures" class="headerlink" title="Class Fixtures"></a>Class Fixtures</h3><blockquote>
<p><strong>When to use</strong>: when you want to create a single test context and share it among all the tests in the class, and have it cleaned up after all the tests in the class have finished. - xunit.net/docs/shared-context</p>
</blockquote>
<p>Create the fixture the same as above but it will not need the <code>CollectionDefinition</code> class.</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FindStuffFixture</span> : <span class="title">IAsyncLifetime</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ... private state</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FindStuffFixture</span>(<span class="params">CollectionFixture collectionFixture</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// ... set private state</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">InitializeAsync</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// ... seed data using `collectionFixture` clients</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> tasks = <span class="keyword">new</span> List&lt;Task&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ... collection of tasks to run in parallel</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">await</span> Task.WhenAll(tasks);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ... its sensible to still wait a 1 to 10 seconds</span></span><br><span class="line">        <span class="keyword">await</span> Task.Delay(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">DisposeAsync</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// ... cleanup if needed </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// then return</span></span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Create the tests and inherit/implement <code>IClassFixture&lt;T&gt;</code>. Note that <code>[Collection(&quot;Shared Collection Fixture&quot;)]</code> was only added to allow the test access to <code>CollectionFixture</code> which is where the clients are constructed.</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Collection(<span class="meta-string">&quot;Shared Collection Fixture&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FindStuffTests</span> : <span class="title">IClassFixture</span>&lt;<span class="title">FindStuffFixture</span>&gt;, <span class="title">IAsyncLifetime</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FindStuffTests</span>(<span class="params">CollectionFixture collectionFixture, FindStuffFixture findStuffFixture</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _findStuffFixture_ = findStuffFixture;</span><br><span class="line">        _collectionFixture = collectionFixture;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Fact</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">U_I_E</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// Arrange</span></span><br><span class="line">        <span class="comment">// Act</span></span><br><span class="line">        <span class="comment">// Assert</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://automationpanda.com/2017/10/19/in-bdd-what-should-be-a-feature/">In BDD what should be a feature</a></li>
<li><a target="_blank" rel="noopener" href="https://www.softwaretestinghelp.com/the-difference-between-unit-integration-and-functional-testing/#What_is_Integration_Testing">What is Integration Testing</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://carlpaton.github.io/2022/01/integration-tests/" data-id="ckz1huu7k0001ooona26zewlg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/software-testing/" rel="tag">software testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wip/" rel="tag">wip</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/02/sonatype-oss-index/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Sonatype OSS Index
        
      </div>
    </a>
  
  
    <a href="/2022/01/personal-development-plan/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Personal Development Plan</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap" class="widget-wrap">
  <div id="site_search">
    <h3 class="widget-title">Search</h3>
    <input
      type="text"
      id="local-search-input"
      name="q"
      results="0"
      placeholder="Search..."
      class="form-control"
    />
    <div id="local-search-result"></div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/microcontroller-assembly-code/">Microcontrollers and Assembly Code</a>
          </li>
        
          <li>
            <a href="/2022/03/charlieplexing-leds/">Charlieplexing LEDs</a>
          </li>
        
          <li>
            <a href="/2022/03/data-structures-algorithms-in-c-sharp/">Data Structures and Algorithms in C#</a>
          </li>
        
          <li>
            <a href="/2022/03/aws-cloudformation/">AWS CloudFormation</a>
          </li>
        
          <li>
            <a href="/2022/03/minimal-api-instant-apis/">Minimal API InstantAPIs</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/net-library/" style="font-size: 11.5px;">.net library</a> <a href="/tags/agile/" style="font-size: 10.5px;">agile</a> <a href="/tags/angular/" style="font-size: 15px;">angular</a> <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/anti-pattern/" style="font-size: 10px;">anti pattern</a> <a href="/tags/architecture/" style="font-size: 14px;">architecture</a> <a href="/tags/arduino/" style="font-size: 11px;">arduino</a> <a href="/tags/assembly/" style="font-size: 10px;">assembly</a> <a href="/tags/authentication/" style="font-size: 12.5px;">authentication</a> <a href="/tags/aws/" style="font-size: 16px;">aws</a> <a href="/tags/beer/" style="font-size: 10px;">beer</a> <a href="/tags/behavioural-patterns/" style="font-size: 14.5px;">behavioural patterns</a> <a href="/tags/board-games/" style="font-size: 10px;">board games</a> <a href="/tags/browser-utilities/" style="font-size: 10.5px;">browser utilities</a> <a href="/tags/c/" style="font-size: 20px;">c#</a> <a href="/tags/cad/" style="font-size: 10.5px;">cad</a> <a href="/tags/cam/" style="font-size: 10.5px;">cam</a> <a href="/tags/client-side/" style="font-size: 11.5px;">client side</a> <a href="/tags/cloud-events/" style="font-size: 10.5px;">cloud events</a> <a href="/tags/cnc/" style="font-size: 11.5px;">cnc</a> <a href="/tags/continuous-integration/" style="font-size: 10.5px;">continuous integration</a> <a href="/tags/creational-patterns/" style="font-size: 11.5px;">creational patterns</a> <a href="/tags/css/" style="font-size: 12px;">css</a> <a href="/tags/csv/" style="font-size: 10px;">csv</a> <a href="/tags/data-structures-algorithms/" style="font-size: 10.5px;">data structures algorithms</a> <a href="/tags/ddd/" style="font-size: 11px;">ddd</a> <a href="/tags/dependency-injection/" style="font-size: 12.5px;">dependency injection</a> <a href="/tags/design/" style="font-size: 10px;">design</a> <a href="/tags/docker/" style="font-size: 17.5px;">docker</a> <a href="/tags/docker-compose/" style="font-size: 11px;">docker compose</a> <a href="/tags/elk-stack/" style="font-size: 10px;">elk stack</a> <a href="/tags/encryption/" style="font-size: 11px;">encryption</a> <a href="/tags/feature-management/" style="font-size: 10.5px;">feature management</a> <a href="/tags/food/" style="font-size: 11px;">food</a> <a href="/tags/git/" style="font-size: 11.5px;">git</a> <a href="/tags/hexo/" style="font-size: 10.5px;">hexo</a> <a href="/tags/ide/" style="font-size: 12px;">ide</a> <a href="/tags/iot/" style="font-size: 12.5px;">iot</a> <a href="/tags/javascript/" style="font-size: 12px;">javascript</a> <a href="/tags/jquery/" style="font-size: 11px;">jquery</a> <a href="/tags/json/" style="font-size: 12px;">json</a> <a href="/tags/kibana/" style="font-size: 10.5px;">kibana</a> <a href="/tags/kubernetes/" style="font-size: 10.5px;">kubernetes</a> <a href="/tags/learning-resources/" style="font-size: 13.5px;">learning resources</a> <a href="/tags/life-hacks/" style="font-size: 12px;">life-hacks</a> <a href="/tags/linux/" style="font-size: 12px;">linux</a> <a href="/tags/logging/" style="font-size: 11.5px;">logging</a> <a href="/tags/mocking/" style="font-size: 12px;">mocking</a> <a href="/tags/model-airplanes/" style="font-size: 18px;">model airplanes</a> <a href="/tags/mvc/" style="font-size: 13px;">mvc</a> <a href="/tags/mysql/" style="font-size: 11px;">mysql</a> <a href="/tags/net-core/" style="font-size: 12px;">net core</a> <a href="/tags/nginx/" style="font-size: 10.5px;">nginx</a> <a href="/tags/nuget/" style="font-size: 11.5px;">nuget</a> <a href="/tags/open-source/" style="font-size: 10px;">open source</a> <a href="/tags/orm/" style="font-size: 11.5px;">orm</a> <a href="/tags/patterns-principles/" style="font-size: 19.5px;">patterns principles</a> <a href="/tags/postgresql/" style="font-size: 11px;">postgresql</a> <a href="/tags/power-shell/" style="font-size: 10px;">power shell</a> <a href="/tags/python/" style="font-size: 12px;">python</a> <a href="/tags/random/" style="font-size: 12px;">random</a> <a href="/tags/raspberry-pi/" style="font-size: 17px;">raspberry pi</a> <a href="/tags/reactjs/" style="font-size: 14px;">reactjs</a> <a href="/tags/redis/" style="font-size: 10.5px;">redis</a> <a href="/tags/reporting/" style="font-size: 10.5px;">reporting</a> <a href="/tags/rosetta-code/" style="font-size: 12.5px;">rosetta code</a> <a href="/tags/serialization/" style="font-size: 12.5px;">serialization</a> <a href="/tags/software-testing/" style="font-size: 18.5px;">software testing</a> <a href="/tags/sonarqube/" style="font-size: 10px;">sonarqube</a> <a href="/tags/sql/" style="font-size: 15.5px;">sql</a> <a href="/tags/sqlite/" style="font-size: 10.5px;">sqlite</a> <a href="/tags/ssh/" style="font-size: 11px;">ssh</a> <a href="/tags/static-code-analysis/" style="font-size: 10.5px;">static code analysis</a> <a href="/tags/structural-patterns/" style="font-size: 13.5px;">structural patterns</a> <a href="/tags/swagger/" style="font-size: 10.5px;">swagger</a> <a href="/tags/threading/" style="font-size: 10.5px;">threading</a> <a href="/tags/typescript/" style="font-size: 10.5px;">typescript</a> <a href="/tags/utilities/" style="font-size: 19px;">utilities</a> <a href="/tags/validation/" style="font-size: 10.5px;">validation</a> <a href="/tags/virtualization/" style="font-size: 10.5px;">virtualization</a> <a href="/tags/web-api/" style="font-size: 16.5px;">web api</a> <a href="/tags/web-forms/" style="font-size: 10px;">web forms</a> <a href="/tags/wip/" style="font-size: 19px;">wip</a> <a href="/tags/wood-work/" style="font-size: 11px;">wood work</a> <a href="/tags/wordpress/" style="font-size: 10px;">wordpress</a> <a href="/tags/xamarin/" style="font-size: 10px;">xamarin</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a>
    </div>
  </div>

  
</aside>
        
      </div>
    </div>
  </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Carl Paton |
      Powered by <a href="https://pages.github.com/" target="_blank">Github Pages</a> and <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>





  
<script src="/js/search.js"></script>

  <script type="text/javascript">
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    searchFunc(path, "local-search-input", "local-search-result");
  </script>

</body>
</html>